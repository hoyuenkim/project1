{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _s = $RefreshSig$();\n\nimport { List, Avatar, Card, Empty, Rate, DatePicker, Modal, Input, Button, Form, Space, Select, Row, Col } from \"antd\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useInput } from \"../../../../components/Generalui/CustomHooks\";\nimport NumberFormat from \"react-number-format\";\nimport { useEffect, useState } from \"react\";\nimport { useWindowSize } from \"@react-hook/window-size\";\nimport { useRouter } from \"next/router\";\nimport { CLIENT_HISTORY_REMOVE_REQUEST, LOAD_PAYMENT_HISTORY_REQUEST, RATING_REQUEST, SEARCH_HISTORY_REQUEST } from \"../../../../reducers/payment\";\nimport { PAGE_CHANGE_SUCCESS } from \"../../../../reducers/admin\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar RangePicker = DatePicker.RangePicker;\n\nvar History = function History() {\n  _s();\n\n  var dispatch = useDispatch();\n  var router = useRouter();\n  useEffect(function () {\n    dispatch({\n      type: PAGE_CHANGE_SUCCESS,\n      data: \"admin\"\n    });\n  });\n\n  var _useState = useState(),\n      startDate = _useState[0],\n      setStartDate = _useState[1];\n\n  var _useState2 = useState(),\n      endDate = _useState2[0],\n      setEndDate = _useState2[1];\n\n  var _useInput = useInput(),\n      _useInput2 = _slicedToArray(_useInput, 3),\n      text = _useInput2[0],\n      onChangeText = _useInput2[1],\n      setText = _useInput2[2];\n\n  var _useState3 = useState(\"product\"),\n      select = _useState3[0],\n      setSelect = _useState3[1];\n\n  var _useState4 = useState(false),\n      toggleSearch = _useState4[0],\n      setToggleSearch = _useState4[1];\n\n  var _useState5 = useState(false),\n      searchError = _useState5[0],\n      setSearchError = _useState5[1];\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      isLoggedIn = _useSelector.isLoggedIn,\n      session = _useSelector.session;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.payment;\n  }),\n      history = _useSelector2.history;\n\n  useEffect(function () {\n    dispatch({\n      type: LOAD_PAYMENT_HISTORY_REQUEST,\n      division: session.division,\n      id: session.id\n    });\n  }, []);\n\n  if (!isLoggedIn) {\n    router.back();\n  }\n\n  var _useWindowSize = useWindowSize(),\n      _useWindowSize2 = _slicedToArray(_useWindowSize, 2),\n      windowWidth = _useWindowSize2[0],\n      windowHeight = _useWindowSize2[1];\n\n  var onWindowScroll = function onWindowScroll() {\n    window.scrollTo({\n      top: 0\n    });\n  };\n\n  var onChangeDatePicker = function onChangeDatePicker(e) {\n    if (e === null) {\n      setStartDate(null);\n      setEndDate(null);\n    } else {\n      var start = new Date(e[0]._d);\n      var end = new Date(e[1]._d);\n      setStartDate(start);\n      setEndDate(end);\n    }\n  };\n\n  var onToggleSearch = function onToggleSearch() {\n    if (searchError) {\n      setSearchError(false);\n    }\n\n    setToggleSearch(function (prev) {\n      return !prev;\n    });\n  };\n\n  var dateFormat = \"YYYY/MM/DD\";\n\n  var onChangeSelect = function onChangeSelect(e) {\n    setSelect(e);\n  };\n\n  var onFinishSearch = function onFinishSearch() {\n    dispatch({\n      type: SEARCH_HISTORY_REQUEST,\n      data: {\n        startDate: startDate,\n        endDate: endDate,\n        text: text,\n        select: select,\n        UserId: session.id\n      }\n    });\n    setStartDate(null);\n    setEndDate(null);\n    setText(null);\n    return setToggleSearch(false);\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Modal, {\n      title: \"Search\",\n      visible: toggleSearch,\n      onCancel: onToggleSearch,\n      footer: null,\n      children: /*#__PURE__*/_jsx(Form, {\n        onFinish: onFinishSearch,\n        children: /*#__PURE__*/_jsxs(Space, {\n          direction: \"vertical\",\n          style: {\n            width: \"100%\"\n          },\n          children: [/*#__PURE__*/_jsxs(Row, {\n            gutter: [10, 10],\n            children: [/*#__PURE__*/_jsx(Col, {\n              span: 6,\n              children: /*#__PURE__*/_jsxs(Select, {\n                defaultValue: \"title\",\n                onChange: onChangeSelect,\n                style: {\n                  width: \"100%\"\n                },\n                children: [/*#__PURE__*/_jsx(Select.Option, {\n                  value: \"title\",\n                  children: \"\\uBA54\\uB274\\uBA85\"\n                }), /*#__PURE__*/_jsx(Select.Option, {\n                  value: \"shop\",\n                  children: \"\\uB9E4\\uC7A5\\uBA85\"\n                })]\n              })\n            }), /*#__PURE__*/_jsx(Col, {\n              span: 18,\n              children: /*#__PURE__*/_jsx(Input, {\n                onChange: onChangeText,\n                value: text,\n                style: {\n                  width: \"100%\"\n                }\n              })\n            }), /*#__PURE__*/_jsx(Col, {\n              span: 24,\n              children: /*#__PURE__*/_jsx(RangePicker, {\n                style: {\n                  verticalAlign: \"middle\",\n                  width: \"100%\"\n                },\n                format: dateFormat,\n                onChange: onChangeDatePicker,\n                defaultValue: [startDate, endDate],\n                inputReadOnly: true\n              })\n            })]\n          }), /*#__PURE__*/_jsx(Button, {\n            type: \"primary\",\n            style: {\n              width: \"100%\"\n            },\n            htmlType: \"submit\",\n            children: \"\\uAC80\\uC0C9\"\n          })]\n        })\n      })\n    }), history.length === 0 ? /*#__PURE__*/_jsx(Card, {\n      style: {\n        height: \"100vh\"\n      },\n      extra: /*#__PURE__*/_jsx(Button, {\n        onClick: onToggleSearch,\n        children: \"\\uAC80\\uC0C9\"\n      }),\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        style: {\n          marginTop: windowHeight * 0.3,\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsx(Empty, {}), /*#__PURE__*/_jsx(\"h1\", {\n          children: \"\\uAC70\\uB798\\uB0B4\\uC5ED\\uC774 \\uC874\\uC7AC\\uD558\\uC9C0 \\uC54A\\uC2B5\\uB2C8\\uB2E4\"\n        })]\n      })\n    }) : /*#__PURE__*/_jsx(Card, {\n      extra: /*#__PURE__*/_jsx(Button, {\n        onClick: onToggleSearch,\n        children: \"\\uAC80\\uC0C9\"\n      }),\n      children: /*#__PURE__*/_jsx(List, {\n        itemLayout: \"horizontal\",\n        dataSource: history,\n        renderItem: function renderItem(item) {\n          var date = new Date(item.createdAt);\n          var localeDate = date.toLocaleString();\n\n          var onClickRemoveHistory = function onClickRemoveHistory() {\n            dispatch({\n              type: CLIENT_HISTORY_REMOVE_REQUEST,\n              PaymentId: item.id\n            });\n          };\n\n          return /*#__PURE__*/_jsx(List.Item, {\n            children: /*#__PURE__*/_jsx(Card, {\n              style: {\n                width: \"100%\"\n              },\n              actions: [/*#__PURE__*/_jsx(\"div\", {\n                onClick: onClickRemoveHistory,\n                children: \"\\uACB0\\uC81C\\uCDE8\\uC18C\"\n              })],\n              extra: item.status ? \"결제완료\" : \"취소요청\",\n              children: /*#__PURE__*/_jsx(List.Item.Meta, {\n                title: /*#__PURE__*/_jsxs(_Fragment, {\n                  children: [item.Shop.name, \"_\", item.Product.title, \"_\", localeDate]\n                }),\n                description: /*#__PURE__*/_jsxs(_Fragment, {\n                  children: [/*#__PURE__*/_jsxs(\"p\", {\n                    children: [\"\\uACB0\\uC81C\\uC218\\uB7C9:\", \" \", /*#__PURE__*/_jsx(NumberFormat, {\n                      value: item.quantity,\n                      displayType: \"text\",\n                      thousandSeparator: true\n                    }), \"\\uAC1C, \\uACB0\\uC81C\\uB2E8\\uAC00:\", \" \", /*#__PURE__*/_jsx(NumberFormat, {\n                      value: item.price,\n                      displayType: \"text\",\n                      thousandSeparator: true\n                    }), \"\\uC6D0\"]\n                  }), /*#__PURE__*/_jsxs(\"h3\", {\n                    children: [\"\\uACB0\\uC81C\\uAE08\\uC561:\", \" \", /*#__PURE__*/_jsx(NumberFormat, {\n                      value: item.price * item.quantity,\n                      displayType: \"text\",\n                      thousandSeparator: true\n                    }), \"\\uC6D0\"]\n                  })]\n                }),\n                avatar: /*#__PURE__*/_jsx(Avatar, {\n                  size: 50,\n                  shape: \"square\",\n                  src: \"\".concat(process.env.BACKEND_IP, \"/uploads/\").concat(item.Product.Images[0].url)\n                })\n              })\n            })\n          });\n        }\n      })\n    })]\n  });\n};\n\n_s(History, \"bjbC+uArekANLqvPg2qvPxan73k=\", false, function () {\n  return [useDispatch, useRouter, useInput, useSelector, useSelector, useWindowSize];\n});\n\n_c = History;\nexport default History;\n\nvar _c;\n\n$RefreshReg$(_c, \"History\");","map":{"version":3,"sources":["C:/Users/hoyuen/Documents/dev/project1/frontend/pages/shop/admin/[ShopId]/history.js"],"names":["List","Avatar","Card","Empty","Rate","DatePicker","Modal","Input","Button","Form","Space","Select","Row","Col","useDispatch","useSelector","useInput","NumberFormat","useEffect","useState","useWindowSize","useRouter","CLIENT_HISTORY_REMOVE_REQUEST","LOAD_PAYMENT_HISTORY_REQUEST","RATING_REQUEST","SEARCH_HISTORY_REQUEST","PAGE_CHANGE_SUCCESS","RangePicker","History","dispatch","router","type","data","startDate","setStartDate","endDate","setEndDate","text","onChangeText","setText","select","setSelect","toggleSearch","setToggleSearch","searchError","setSearchError","state","user","isLoggedIn","session","payment","history","division","id","back","windowWidth","windowHeight","onWindowScroll","window","scrollTo","top","onChangeDatePicker","e","start","Date","_d","end","onToggleSearch","prev","dateFormat","onChangeSelect","onFinishSearch","UserId","width","verticalAlign","length","height","marginTop","textAlign","item","date","createdAt","localeDate","toLocaleString","onClickRemoveHistory","PaymentId","status","Shop","name","Product","title","quantity","price","process","env","BACKEND_IP","Images","url"],"mappings":"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","sourcesContent":["import {\n  List,\n  Avatar,\n  Card,\n  Empty,\n  Rate,\n  DatePicker,\n  Modal,\n  Input,\n  Button,\n  Form,\n  Space,\n  Select,\n  Row,\n  Col,\n} from \"antd\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useInput } from \"../../../../components/Generalui/CustomHooks\";\n\nimport NumberFormat from \"react-number-format\";\n\nimport { useEffect, useState } from \"react\";\nimport { useWindowSize } from \"@react-hook/window-size\";\nimport { useRouter } from \"next/router\";\nimport {\n  CLIENT_HISTORY_REMOVE_REQUEST,\n  LOAD_PAYMENT_HISTORY_REQUEST,\n  RATING_REQUEST,\n  SEARCH_HISTORY_REQUEST,\n} from \"../../../../reducers/payment\";\n\nimport { PAGE_CHANGE_SUCCESS } from \"../../../../reducers/admin\";\n\nconst { RangePicker } = DatePicker;\n\nconst History = () => {\n  const dispatch = useDispatch();\n  const router = useRouter();\n  useEffect(() => {\n    dispatch({ type: PAGE_CHANGE_SUCCESS, data: \"admin\" });\n  });\n\n  const [startDate, setStartDate] = useState();\n  const [endDate, setEndDate] = useState();\n  const [text, onChangeText, setText] = useInput();\n  const [select, setSelect] = useState(\"product\");\n\n  const [toggleSearch, setToggleSearch] = useState(false);\n\n  const [searchError, setSearchError] = useState(false);\n\n  const { isLoggedIn, session } = useSelector((state) => state.user);\n  const { history } = useSelector((state) => state.payment);\n  useEffect(() => {\n    dispatch({\n      type: LOAD_PAYMENT_HISTORY_REQUEST,\n      division: session.division,\n      id: session.id,\n    });\n  }, []);\n\n  if (!isLoggedIn) {\n    router.back();\n  }\n\n  const [windowWidth, windowHeight] = useWindowSize();\n\n  const onWindowScroll = () => {\n    window.scrollTo({ top: 0 });\n  };\n\n  const onChangeDatePicker = (e) => {\n    if (e === null) {\n      setStartDate(null);\n      setEndDate(null);\n    } else {\n      const start = new Date(e[0]._d);\n      const end = new Date(e[1]._d);\n      setStartDate(start);\n      setEndDate(end);\n    }\n  };\n\n  const onToggleSearch = () => {\n    if (searchError) {\n      setSearchError(false);\n    }\n    setToggleSearch((prev) => !prev);\n  };\n\n  const dateFormat = \"YYYY/MM/DD\";\n\n  const onChangeSelect = (e) => {\n    setSelect(e);\n  };\n\n  const onFinishSearch = () => {\n    dispatch({\n      type: SEARCH_HISTORY_REQUEST,\n      data: {\n        startDate,\n        endDate,\n        text,\n        select,\n        UserId: session.id,\n      },\n    });\n    setStartDate(null);\n    setEndDate(null);\n    setText(null);\n    return setToggleSearch(false);\n  };\n\n  return (\n    <>\n      <Modal title={\"Search\"} visible={toggleSearch} onCancel={onToggleSearch} footer={null}>\n        <Form onFinish={onFinishSearch}>\n          <Space direction={\"vertical\"} style={{ width: \"100%\" }}>\n            <Row gutter={[10, 10]}>\n              <Col span={6}>\n                <Select defaultValue={\"title\"} onChange={onChangeSelect} style={{ width: \"100%\" }}>\n                  <Select.Option value={\"title\"}>메뉴명</Select.Option>\n                  <Select.Option value={\"shop\"}>매장명</Select.Option>\n                </Select>\n              </Col>\n              <Col span={18}>\n                <Input onChange={onChangeText} value={text} style={{ width: \"100%\" }} />\n              </Col>\n              <Col span={24}>\n                <RangePicker\n                  style={{ verticalAlign: \"middle\", width: \"100%\" }}\n                  format={dateFormat}\n                  onChange={onChangeDatePicker}\n                  defaultValue={[startDate, endDate]}\n                  inputReadOnly\n                />\n              </Col>\n            </Row>\n\n            <Button type={\"primary\"} style={{ width: \"100%\" }} htmlType={\"submit\"}>\n              검색\n            </Button>\n          </Space>\n        </Form>\n      </Modal>\n\n      {history.length === 0 ? (\n        <Card style={{ height: \"100vh\" }} extra={<Button onClick={onToggleSearch}>검색</Button>}>\n          <div style={{ marginTop: windowHeight * 0.3, textAlign: \"center\" }}>\n            <Empty />\n            <h1>거래내역이 존재하지 않습니다</h1>\n          </div>\n        </Card>\n      ) : (\n        <Card extra={<Button onClick={onToggleSearch}>검색</Button>}>\n          <List\n            itemLayout=\"horizontal\"\n            dataSource={history}\n            renderItem={(item) => {\n              const date = new Date(item.createdAt);\n              const localeDate = date.toLocaleString();\n\n              const onClickRemoveHistory = () => {\n                dispatch({\n                  type: CLIENT_HISTORY_REMOVE_REQUEST,\n                  PaymentId: item.id,\n                });\n              };\n\n              return (\n                <List.Item>\n                  <Card\n                    style={{ width: \"100%\" }}\n                    actions={[<div onClick={onClickRemoveHistory}>결제취소</div>]}\n                    extra={item.status ? \"결제완료\" : \"취소요청\"}\n                  >\n                    <List.Item.Meta\n                      title={\n                        <>\n                          {item.Shop.name}_{item.Product.title}_{localeDate}\n                        </>\n                      }\n                      description={\n                        <>\n                          <p>\n                            결제수량:{\" \"}\n                            <NumberFormat\n                              value={item.quantity}\n                              displayType={\"text\"}\n                              thousandSeparator={true}\n                            />\n                            개, 결제단가:{\" \"}\n                            <NumberFormat\n                              value={item.price}\n                              displayType={\"text\"}\n                              thousandSeparator={true}\n                            />\n                            원\n                          </p>\n                          <h3>\n                            결제금액:{\" \"}\n                            <NumberFormat\n                              value={item.price * item.quantity}\n                              displayType={\"text\"}\n                              thousandSeparator={true}\n                            />\n                            원\n                          </h3>\n                        </>\n                      }\n                      avatar={\n                        <Avatar\n                          size={50}\n                          shape=\"square\"\n                          src={`${process.env.BACKEND_IP}/uploads/${item.Product.Images[0].url}`}\n                        />\n                      }\n                    />\n                  </Card>\n                </List.Item>\n              );\n            }}\n          />\n        </Card>\n      )}\n    </>\n  );\n};\n\nexport default History;\n"]},"metadata":{},"sourceType":"module"}